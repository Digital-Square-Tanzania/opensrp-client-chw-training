indicators:
  #Question 1
  #Male
  - key: "cecap-1-male-total"
    grouping: "CECAP"
    description: "Number of clients who received education on Reproductive cancer prevention"
    indicatorQuery: "SELECT SUM(male_clients_reached) as count
                      FROM ec_cecap_mobilization_session ecms
                      WHERE date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) =  date((substr(mobilization_date, 7, 4) || '-' || substr(mobilization_date, 4, 2) || '-' || '01'))"
    
  - key: "cecap-1-female-total"
    grouping: "CECAP"
    description: "Number of clients who received education on Reproductive cancer prevention"
    indicatorQuery: "SELECT SUM(female_clients_reached) as count
                      FROM ec_cecap_mobilization_session ecms
                      WHERE date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) =  date((substr(mobilization_date, 7, 4) || '-' || substr(mobilization_date, 4, 2) || '-' || '01'))"
    
  - key: "cecap-2-male-14"
    grouping: "CECAP"
    description: "Number of clients who received education on Reproductive cancer prevention and registered"
    indicatorQuery: "SELECT count(DISTINCT ecv.base_entity_id) as count
                      FROM ec_cecap_visit ecv
                      INNER JOIN ec_family_member efm ON efm.base_entity_id = ecv.entity_id
                      WHERE 14 <= (date('Now') - date(efm.dob))
                      AND (efm.gender='Male')
                      AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) =
                      date(substr(strftime('%Y-%m-%d', datetime(ecv.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                      '-' || substr(strftime('%Y-%m-%d', datetime(ecv.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01')"

  - key: "cecap-3-male-14"
    grouping: "CECAP"
    description: "Number of clients who received education on Reproductive cancer prevention and registered"
    indicatorQuery: "SELECT count(DISTINCT ecv.base_entity_id) as count
                      FROM ec_cecap_visit ecv
                      INNER JOIN ec_family_member efm ON efm.base_entity_id = ecv.entity_id
                      INNER JOIN ec_cecap_register ecr ON efm.base_entity_id = ecr.base_entity_id
                      WHERE 14 <= (date('Now') - date(efm.dob))
                      AND hiv_status = 'known_positive'
                      AND topics_covered LIKE '%cervical_cancer%'
                      AND (efm.gender='Male')
                      AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) =
                      date(substr(strftime('%Y-%m-%d', datetime(ecv.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                      '-' || substr(strftime('%Y-%m-%d', datetime(ecv.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01')"
  
  
  
  - key: "cecap-4a-male-14"
    grouping: "CECAP"
    description: "Referred for Cervical cancer screening"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                               INNER JOIN event ev on ev.formSubmissionId = t.reason_reference
                      WHERE
                      14 <= (date('Now') - date(efm.dob))
                      AND (efm.gender='Male')
                      AND ev.json LIKE '%cervical_cancer_screening%'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
  
  
  - key: "cecap-4b-male-14"
    grouping: "CECAP"
    description: "Referred for Breasts cancer screening"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                               INNER JOIN event ev on ev.formSubmissionId = t.reason_reference
                      WHERE
                      14 <= (date('Now') - date(efm.dob))
                      AND (efm.gender='Male')
                      AND ev.json LIKE '%breast_cancer_screening%'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
  
  
  - key: "cecap-4c-male-14"
    grouping: "CECAP"
    description: "Referred for Suspicion of cancer"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                               INNER JOIN event ev on ev.formSubmissionId = t.reason_reference
                      WHERE
                      14 <= (date('Now') - date(efm.dob))
                      AND (efm.gender='Male')
                      AND ev.json LIKE '%suspected_of_having_cancer%'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
  
  
  - key: "cecap-4d-male-14"
    grouping: "CECAP"
    description: "Referred for Prostate screening"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                               INNER JOIN event ev on ev.formSubmissionId = t.reason_reference
                      WHERE
                      14 <= (date('Now') - date(efm.dob))
                      AND (efm.gender='Male')
                      AND ev.json LIKE '%prostate_cancer_screening%'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
  
  
  - key: "cecap-5-male-14"
    grouping: "CECAP"
    description: "Completed Referrals"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                      WHERE
                      14 <= (date('Now') - date(efm.dob))
                      AND (efm.gender='Male')
                      AND t.business_status = 'Complete'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
    
  - key: "cecap-2-female-14"
    grouping: "CECAP"
    description: "Number of clients who received education on Reproductive cancer prevention and registered"
    indicatorQuery: "SELECT count(DISTINCT ecv.base_entity_id) as count
                      FROM ec_cecap_visit ecv
                      INNER JOIN ec_family_member efm ON efm.base_entity_id = ecv.entity_id
                      WHERE 14 <= (date('Now') - date(efm.dob))
                      AND (efm.gender='Female')
                      AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) =
                      date(substr(strftime('%Y-%m-%d', datetime(ecv.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                      '-' || substr(strftime('%Y-%m-%d', datetime(ecv.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01')"

  - key: "cecap-3-female-14"
    grouping: "CECAP"
    description: "Number of clients who received education on Reproductive cancer prevention and registered"
    indicatorQuery: "SELECT count(DISTINCT ecv.base_entity_id) as count
                      FROM ec_cecap_visit ecv
                      INNER JOIN ec_family_member efm ON efm.base_entity_id = ecv.entity_id
                      INNER JOIN ec_cecap_register ecr ON efm.base_entity_id = ecr.base_entity_id
                      WHERE 14 <= (date('Now') - date(efm.dob))
                      AND hiv_status = 'known_positive'
                      AND topics_covered LIKE '%cervical_cancer%'
                      AND (efm.gender='Female')
                      AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) =
                      date(substr(strftime('%Y-%m-%d', datetime(ecv.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                      '-' || substr(strftime('%Y-%m-%d', datetime(ecv.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01')"
  
  
  
  - key: "cecap-4a-female-14"
    grouping: "CECAP"
    description: "Referred for Cervical cancer screening"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                               INNER JOIN event ev on ev.formSubmissionId = t.reason_reference
                      WHERE
                      14 <= (date('Now') - date(efm.dob))
                      AND (efm.gender='Female')
                      AND ev.json LIKE '%cervical_cancer_screening%'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
  
  
  - key: "cecap-4b-female-14"
    grouping: "CECAP"
    description: "Referred for Breasts cancer screening"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                               INNER JOIN event ev on ev.formSubmissionId = t.reason_reference
                      WHERE
                      14 <= (date('Now') - date(efm.dob))
                      AND (efm.gender='Female')
                      AND ev.json LIKE '%breast_cancer_screening%'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
  
  
  - key: "cecap-4c-female-14"
    grouping: "CECAP"
    description: "Referred for Suspicion of cancer"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                               INNER JOIN event ev on ev.formSubmissionId = t.reason_reference
                      WHERE
                      14 <= (date('Now') - date(efm.dob))
                      AND (efm.gender='Female')
                      AND ev.json LIKE '%suspected_of_having_cancer%'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
  
  
  - key: "cecap-4d-female-14"
    grouping: "CECAP"
    description: "Referred for Prostate screening"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                               INNER JOIN event ev on ev.formSubmissionId = t.reason_reference
                      WHERE
                      14 <= (date('Now') - date(efm.dob))
                      AND (efm.gender='Female')
                      AND ev.json LIKE '%prostate_cancer_screening%'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
  
  
  - key: "cecap-5-female-14"
    grouping: "CECAP"
    description: "Completed Referrals"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                      WHERE
                      14 <= (date('Now') - date(efm.dob))
                      AND (efm.gender='Female')
                      AND t.business_status = 'Complete'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
    
#    15 - 24
  - key: "cecap-2-male-15-24"
    grouping: "CECAP"
    description: "Number of clients who received education on Reproductive cancer prevention and registered"
    indicatorQuery: "SELECT count(DISTINCT ecv.base_entity_id) as count
                      FROM ec_cecap_visit ecv
                      INNER JOIN ec_family_member efm ON efm.base_entity_id = ecv.entity_id
                      WHERE 15 <= (date('Now') - date(efm.dob)) AND (date('Now') - date(efm.dob)) < 25 AND (date('Now') - date(efm.dob)) < 25
                      AND (efm.gender='Male')
                      AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) =
                      date(substr(strftime('%Y-%m-%d', datetime(ecv.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                      '-' || substr(strftime('%Y-%m-%d', datetime(ecv.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01')"


  - key: "cecap-3-male-15-24"
    grouping: "CECAP"
    description: "Number of clients who received education on Reproductive cancer prevention and registered"
    indicatorQuery: "SELECT count(DISTINCT ecv.base_entity_id) as count
                      FROM ec_cecap_visit ecv
                      INNER JOIN ec_family_member efm ON efm.base_entity_id = ecv.entity_id
                      INNER JOIN ec_cecap_register ecr ON efm.base_entity_id = ecr.base_entity_id
                      WHERE
                      15 <= (date('Now') - date(efm.dob)) AND (date('Now') - date(efm.dob)) < 25
                      AND hiv_status = 'known_positive'
                      AND topics_covered LIKE '%cervical_cancer%'
                      AND (efm.gender='Male')
                      AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) =
                      date(substr(strftime('%Y-%m-%d', datetime(ecv.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                      '-' || substr(strftime('%Y-%m-%d', datetime(ecv.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01')"
  
  
  
  - key: "cecap-4a-male-15-24"
    grouping: "CECAP"
    description: "Referred for Cervical cancer screening"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                               INNER JOIN event ev on ev.formSubmissionId = t.reason_reference
                      WHERE
                      15 <= (date('Now') - date(efm.dob)) AND (date('Now') - date(efm.dob)) < 25
                      AND (efm.gender='Male')
                      AND ev.json LIKE '%cervical_cancer_screening%'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
  
  
  - key: "cecap-4b-male-15-24"
    grouping: "CECAP"
    description: "Referred for Breasts cancer screening"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                               INNER JOIN event ev on ev.formSubmissionId = t.reason_reference
                      WHERE
                      15 <= (date('Now') - date(efm.dob)) AND (date('Now') - date(efm.dob)) < 25
                      AND (efm.gender='Male')
                      AND ev.json LIKE '%breast_cancer_screening%'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
  
  
  - key: "cecap-4c-male-15-24"
    grouping: "CECAP"
    description: "Referred for Suspicion of cancer"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                               INNER JOIN event ev on ev.formSubmissionId = t.reason_reference
                      WHERE
                      15 <= (date('Now') - date(efm.dob)) AND (date('Now') - date(efm.dob)) < 25
                      AND (efm.gender='Male')
                      AND ev.json LIKE '%suspected_of_having_cancer%'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
  
  
  - key: "cecap-4d-male-15-24"
    grouping: "CECAP"
    description: "Referred for Prostate screening"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                               INNER JOIN event ev on ev.formSubmissionId = t.reason_reference
                      WHERE
                      15 <= (date('Now') - date(efm.dob)) AND (date('Now') - date(efm.dob)) < 25
                      AND (efm.gender='Male')
                      AND ev.json LIKE '%prostate_cancer_screening%'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
  
  
  - key: "cecap-5-male-15-24"
    grouping: "CECAP"
    description: "Completed Referrals"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                      WHERE
                      15 <= (date('Now') - date(efm.dob)) AND (date('Now') - date(efm.dob)) < 25
                      AND (efm.gender='Male')
                      AND t.business_status = 'Complete'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
    
  - key: "cecap-2-female-15-24"
    grouping: "CECAP"
    description: "Number of clients who received education on Reproductive cancer prevention and registered"
    indicatorQuery: "SELECT count(DISTINCT ecv.base_entity_id) as count
                      FROM ec_cecap_visit ecv
                      INNER JOIN ec_family_member efm ON efm.base_entity_id = ecv.entity_id
                      WHERE
                      15 <= (date('Now') - date(efm.dob)) AND (date('Now') - date(efm.dob)) < 25
                      AND (efm.gender='Female')
                      AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) =
                      date(substr(strftime('%Y-%m-%d', datetime(ecv.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                      '-' || substr(strftime('%Y-%m-%d', datetime(ecv.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01')"

  - key: "cecap-3-female-15-24"
    grouping: "CECAP"
    description: "Number of clients who received education on Reproductive cancer prevention and registered"
    indicatorQuery: "SELECT count(DISTINCT ecv.base_entity_id) as count
                      FROM ec_cecap_visit ecv
                      INNER JOIN ec_family_member efm ON efm.base_entity_id = ecv.entity_id
                      INNER JOIN ec_cecap_register ecr ON efm.base_entity_id = ecr.base_entity_id
                      WHERE
                      15 <= (date('Now') - date(efm.dob)) AND (date('Now') - date(efm.dob)) < 25
                      AND hiv_status = 'known_positive'
                      AND topics_covered LIKE '%cervical_cancer%'
                      AND (efm.gender='Female')
                      AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) =
                      date(substr(strftime('%Y-%m-%d', datetime(ecv.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                      '-' || substr(strftime('%Y-%m-%d', datetime(ecv.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01')"
  
  
  
  - key: "cecap-4a-female-15-24"
    grouping: "CECAP"
    description: "Referred for Cervical cancer screening"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                               INNER JOIN event ev on ev.formSubmissionId = t.reason_reference
                      WHERE
                      15 <= (date('Now') - date(efm.dob)) AND (date('Now') - date(efm.dob)) < 25
                      AND (efm.gender='Female')
                      AND ev.json LIKE '%cervical_cancer_screening%'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
  
  
  - key: "cecap-4b-female-15-24"
    grouping: "CECAP"
    description: "Referred for Breasts cancer screening"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                               INNER JOIN event ev on ev.formSubmissionId = t.reason_reference
                      WHERE
                      15 <= (date('Now') - date(efm.dob)) AND (date('Now') - date(efm.dob)) < 25
                      AND (efm.gender='Female')
                      AND ev.json LIKE '%breast_cancer_screening%'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
  
  
  - key: "cecap-4c-female-15-24"
    grouping: "CECAP"
    description: "Referred for Suspicion of cancer"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                               INNER JOIN event ev on ev.formSubmissionId = t.reason_reference
                      WHERE
                      15 <= (date('Now') - date(efm.dob)) AND (date('Now') - date(efm.dob)) < 25
                      AND (efm.gender='Female')
                      AND ev.json LIKE '%suspected_of_having_cancer%'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
  
  
  - key: "cecap-4d-female-15-24"
    grouping: "CECAP"
    description: "Referred for Prostate screening"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                               INNER JOIN event ev on ev.formSubmissionId = t.reason_reference
                      WHERE
                      15 <= (date('Now') - date(efm.dob)) AND (date('Now') - date(efm.dob)) < 25
                      AND (efm.gender='Female')
                      AND ev.json LIKE '%prostate_cancer_screening%'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
  
  
  - key: "cecap-5-female-15-24"
    grouping: "CECAP"
    description: "Completed Referrals"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                      WHERE
                      15 <= (date('Now') - date(efm.dob)) AND (date('Now') - date(efm.dob)) < 25
                      AND (efm.gender='Female')
                      AND t.business_status = 'Complete'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
    
#    25 - 30
  - key: "cecap-2-male-25-30"
    grouping: "CECAP"
    description: "Number of clients who received education on Reproductive cancer prevention and registered"
    indicatorQuery: "SELECT count(DISTINCT ecv.base_entity_id) as count
                      FROM ec_cecap_visit ecv
                      INNER JOIN ec_family_member efm ON efm.base_entity_id = ecv.entity_id
                      WHERE
                      25 <= (date('Now') - date(efm.dob)) AND (date('Now') - date(efm.dob)) < 31
                      AND (efm.gender='Male')
                      AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) =
                      date(substr(strftime('%Y-%m-%d', datetime(ecv.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                      '-' || substr(strftime('%Y-%m-%d', datetime(ecv.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01')"

  - key: "cecap-3-male-25-30"
    grouping: "CECAP"
    description: "Number of clients who received education on Reproductive cancer prevention and registered"
    indicatorQuery: "SELECT count(DISTINCT ecv.base_entity_id) as count
                      FROM ec_cecap_visit ecv
                      INNER JOIN ec_family_member efm ON efm.base_entity_id = ecv.entity_id
                      INNER JOIN ec_cecap_register ecr ON efm.base_entity_id = ecr.base_entity_id
                      WHERE
                      25 <= (date('Now') - date(efm.dob)) AND (date('Now') - date(efm.dob)) < 31
                      AND hiv_status = 'known_positive'
                      AND topics_covered LIKE '%cervical_cancer%'
                      AND (efm.gender='Male')
                      AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) =
                      date(substr(strftime('%Y-%m-%d', datetime(ecv.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                      '-' || substr(strftime('%Y-%m-%d', datetime(ecv.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01')"
  
  
  
  - key: "cecap-4a-male-25-30"
    grouping: "CECAP"
    description: "Referred for Cervical cancer screening"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                               INNER JOIN event ev on ev.formSubmissionId = t.reason_reference
                      WHERE
                      25 <= (date('Now') - date(efm.dob)) AND (date('Now') - date(efm.dob)) < 31
                      AND (efm.gender='Male')
                      AND ev.json LIKE '%cervical_cancer_screening%'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
  
  
  - key: "cecap-4b-male-25-30"
    grouping: "CECAP"
    description: "Referred for Breasts cancer screening"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                               INNER JOIN event ev on ev.formSubmissionId = t.reason_reference
                      WHERE
                      25 <= (date('Now') - date(efm.dob)) AND (date('Now') - date(efm.dob)) < 31
                      AND (efm.gender='Male')
                      AND ev.json LIKE '%breast_cancer_screening%'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
  
  
  - key: "cecap-4c-male-25-30"
    grouping: "CECAP"
    description: "Referred for Suspicion of cancer"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                               INNER JOIN event ev on ev.formSubmissionId = t.reason_reference
                      WHERE
                      25 <= (date('Now') - date(efm.dob)) AND (date('Now') - date(efm.dob)) < 31
                      AND (efm.gender='Male')
                      AND ev.json LIKE '%suspected_of_having_cancer%'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
  
  
  - key: "cecap-4d-male-25-30"
    grouping: "CECAP"
    description: "Referred for Prostate screening"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                               INNER JOIN event ev on ev.formSubmissionId = t.reason_reference
                      WHERE
                      25 <= (date('Now') - date(efm.dob)) AND (date('Now') - date(efm.dob)) < 31
                      AND (efm.gender='Male')
                      AND ev.json LIKE '%prostate_cancer_screening%'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
  
  
  - key: "cecap-5-male-25-30"
    grouping: "CECAP"
    description: "Completed Referrals"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                      WHERE
                      25 <= (date('Now') - date(efm.dob)) AND (date('Now') - date(efm.dob)) < 31
                      AND (efm.gender='Male')
                      AND t.business_status = 'Complete'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
    
  - key: "cecap-2-female-25-30"
    grouping: "CECAP"
    description: "Number of clients who received education on Reproductive cancer prevention and registered"
    indicatorQuery: "SELECT count(DISTINCT ecv.base_entity_id) as count
                      FROM ec_cecap_visit ecv
                      INNER JOIN ec_family_member efm ON efm.base_entity_id = ecv.entity_id
                      WHERE
                      25 <= (date('Now') - date(efm.dob)) AND (date('Now') - date(efm.dob)) < 31
                      AND (efm.gender='Female')
                      AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) =
                      date(substr(strftime('%Y-%m-%d', datetime(ecv.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                      '-' || substr(strftime('%Y-%m-%d', datetime(ecv.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01')"

  - key: "cecap-3-female-25-30"
    grouping: "CECAP"
    description: "Number of clients who received education on Reproductive cancer prevention and registered"
    indicatorQuery: "SELECT count(DISTINCT ecv.base_entity_id) as count
                      FROM ec_cecap_visit ecv
                      INNER JOIN ec_family_member efm ON efm.base_entity_id = ecv.entity_id
                      INNER JOIN ec_cecap_register ecr ON efm.base_entity_id = ecr.base_entity_id
                      WHERE
                      25 <= (date('Now') - date(efm.dob)) AND (date('Now') - date(efm.dob)) < 31
                      AND hiv_status = 'known_positive'
                      AND topics_covered LIKE '%cervical_cancer%'
                      AND (efm.gender='Female')
                      AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) =
                      date(substr(strftime('%Y-%m-%d', datetime(ecv.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                      '-' || substr(strftime('%Y-%m-%d', datetime(ecv.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01')"
  
  
  
  - key: "cecap-4a-female-25-30"
    grouping: "CECAP"
    description: "Referred for Cervical cancer screening"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                               INNER JOIN event ev on ev.formSubmissionId = t.reason_reference
                      WHERE
                      25 <= (date('Now') - date(efm.dob)) AND (date('Now') - date(efm.dob)) < 31
                      AND (efm.gender='Female')
                      AND ev.json LIKE '%cervical_cancer_screening%'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
  
  
  - key: "cecap-4b-female-25-30"
    grouping: "CECAP"
    description: "Referred for Breasts cancer screening"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                               INNER JOIN event ev on ev.formSubmissionId = t.reason_reference
                      WHERE
                      25 <= (date('Now') - date(efm.dob)) AND (date('Now') - date(efm.dob)) < 31
                      AND (efm.gender='Female')
                      AND ev.json LIKE '%breast_cancer_screening%'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
  
  
  - key: "cecap-4c-female-25-30"
    grouping: "CECAP"
    description: "Referred for Suspicion of cancer"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                               INNER JOIN event ev on ev.formSubmissionId = t.reason_reference
                      WHERE
                      25 <= (date('Now') - date(efm.dob)) AND (date('Now') - date(efm.dob)) < 31
                      AND (efm.gender='Female')
                      AND ev.json LIKE '%suspected_of_having_cancer%'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
  
  
  - key: "cecap-4d-female-25-30"
    grouping: "CECAP"
    description: "Referred for Prostate screening"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                               INNER JOIN event ev on ev.formSubmissionId = t.reason_reference
                      WHERE
                      25 <= (date('Now') - date(efm.dob)) AND (date('Now') - date(efm.dob)) < 31
                      AND (efm.gender='Female')
                      AND ev.json LIKE '%prostate_cancer_screening%'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
  
  
  - key: "cecap-5-female-25-30"
    grouping: "CECAP"
    description: "Completed Referrals"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                      WHERE
                      25 <= (date('Now') - date(efm.dob)) AND (date('Now') - date(efm.dob)) < 31
                      AND (efm.gender='Female')
                      AND t.business_status = 'Complete'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
    
#    31 - 50
  - key: "cecap-2-male-31-50"
    grouping: "CECAP"
    description: "Number of clients who received education on Reproductive cancer prevention and registered"
    indicatorQuery: "SELECT count(DISTINCT ecv.base_entity_id) as count
                      FROM ec_cecap_visit ecv
                      INNER JOIN ec_family_member efm ON efm.base_entity_id = ecv.entity_id
                      WHERE
                      31 <= (date('Now') - date(efm.dob)) AND (date('Now') - date(efm.dob)) < 51
                      AND (efm.gender='Male')
                      AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) =
                      date(substr(strftime('%Y-%m-%d', datetime(ecv.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                      '-' || substr(strftime('%Y-%m-%d', datetime(ecv.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01')"

  - key: "cecap-3-male-31-50"
    grouping: "CECAP"
    description: "Number of clients who received education on Reproductive cancer prevention and registered"
    indicatorQuery: "SELECT count(DISTINCT ecv.base_entity_id) as count
                      FROM ec_cecap_visit ecv
                      INNER JOIN ec_family_member efm ON efm.base_entity_id = ecv.entity_id
                      INNER JOIN ec_cecap_register ecr ON efm.base_entity_id = ecr.base_entity_id
                      WHERE
                      31 <= (date('Now') - date(efm.dob)) AND (date('Now') - date(efm.dob)) < 51
                      AND hiv_status = 'known_positive'
                      AND topics_covered LIKE '%cervical_cancer%'
                      AND (efm.gender='Male')
                      AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) =
                      date(substr(strftime('%Y-%m-%d', datetime(ecv.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                      '-' || substr(strftime('%Y-%m-%d', datetime(ecv.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01')"
  
  
  
  - key: "cecap-4a-male-31-50"
    grouping: "CECAP"
    description: "Referred for Cervical cancer screening"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                               INNER JOIN event ev on ev.formSubmissionId = t.reason_reference
                      WHERE
                      31 <= (date('Now') - date(efm.dob)) AND (date('Now') - date(efm.dob)) < 51
                      AND (efm.gender='Male')
                      AND ev.json LIKE '%cervical_cancer_screening%'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
  
  
  - key: "cecap-4b-male-31-50"
    grouping: "CECAP"
    description: "Referred for Breasts cancer screening"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                               INNER JOIN event ev on ev.formSubmissionId = t.reason_reference
                      WHERE
                      31 <= (date('Now') - date(efm.dob)) AND (date('Now') - date(efm.dob)) < 51
                      AND (efm.gender='Male')
                      AND ev.json LIKE '%breast_cancer_screening%'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
  
  
  - key: "cecap-4c-male-31-50"
    grouping: "CECAP"
    description: "Referred for Suspicion of cancer"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                               INNER JOIN event ev on ev.formSubmissionId = t.reason_reference
                      WHERE
                      31 <= (date('Now') - date(efm.dob)) AND (date('Now') - date(efm.dob)) < 51
                      AND (efm.gender='Male')
                      AND ev.json LIKE '%suspected_of_having_cancer%'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
  
  
  - key: "cecap-4d-male-31-50"
    grouping: "CECAP"
    description: "Referred for Prostate screening"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                               INNER JOIN event ev on ev.formSubmissionId = t.reason_reference
                      WHERE
                      31 <= (date('Now') - date(efm.dob)) AND (date('Now') - date(efm.dob)) < 51
                      AND (efm.gender='Male')
                      AND ev.json LIKE '%prostate_cancer_screening%'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
  
  
  - key: "cecap-5-male-31-50"
    grouping: "CECAP"
    description: "Completed Referrals"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                      WHERE
                      31 <= (date('Now') - date(efm.dob)) AND (date('Now') - date(efm.dob)) < 51
                      AND (efm.gender='Male')
                      AND t.business_status = 'Complete'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
    
  - key: "cecap-2-female-31-50"
    grouping: "CECAP"
    description: "Number of clients who received education on Reproductive cancer prevention and registered"
    indicatorQuery: "SELECT count(DISTINCT ecv.base_entity_id) as count
                      FROM ec_cecap_visit ecv
                      INNER JOIN ec_family_member efm ON efm.base_entity_id = ecv.entity_id
                      WHERE
                      31 <= (date('Now') - date(efm.dob)) AND (date('Now') - date(efm.dob)) < 51
                      AND (efm.gender='Female')
                      AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) =
                      date(substr(strftime('%Y-%m-%d', datetime(ecv.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                      '-' || substr(strftime('%Y-%m-%d', datetime(ecv.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01')"

  - key: "cecap-3-female-31-50"
    grouping: "CECAP"
    description: "Number of clients who received education on Reproductive cancer prevention and registered"
    indicatorQuery: "SELECT count(DISTINCT ecv.base_entity_id) as count
                      FROM ec_cecap_visit ecv
                      INNER JOIN ec_family_member efm ON efm.base_entity_id = ecv.entity_id
                      INNER JOIN ec_cecap_register ecr ON efm.base_entity_id = ecr.base_entity_id
                      WHERE
                      31 <= (date('Now') - date(efm.dob)) AND (date('Now') - date(efm.dob)) < 51
                      AND hiv_status = 'known_positive'
                      AND topics_covered LIKE '%cervical_cancer%'
                      AND (efm.gender='Female')
                      AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) =
                      date(substr(strftime('%Y-%m-%d', datetime(ecv.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                      '-' || substr(strftime('%Y-%m-%d', datetime(ecv.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01')"
  
  
  
  - key: "cecap-4a-female-31-50"
    grouping: "CECAP"
    description: "Referred for Cervical cancer screening"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                               INNER JOIN event ev on ev.formSubmissionId = t.reason_reference
                      WHERE
                      31 <= (date('Now') - date(efm.dob)) AND (date('Now') - date(efm.dob)) < 51
                      AND (efm.gender='Female')
                      AND ev.json LIKE '%cervical_cancer_screening%'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
  
  
  - key: "cecap-4b-female-31-50"
    grouping: "CECAP"
    description: "Referred for Breasts cancer screening"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                               INNER JOIN event ev on ev.formSubmissionId = t.reason_reference
                      WHERE
                      31 <= (date('Now') - date(efm.dob)) AND (date('Now') - date(efm.dob)) < 51
                      AND (efm.gender='Female')
                      AND ev.json LIKE '%breast_cancer_screening%'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
  
  
  - key: "cecap-4c-female-31-50"
    grouping: "CECAP"
    description: "Referred for Suspicion of cancer"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                               INNER JOIN event ev on ev.formSubmissionId = t.reason_reference
                      WHERE
                      31 <= (date('Now') - date(efm.dob)) AND (date('Now') - date(efm.dob)) < 51
                      AND (efm.gender='Female')
                      AND ev.json LIKE '%suspected_of_having_cancer%'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
  
  
  - key: "cecap-4d-female-31-50"
    grouping: "CECAP"
    description: "Referred for Prostate screening"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                               INNER JOIN event ev on ev.formSubmissionId = t.reason_reference
                      WHERE
                      31 <= (date('Now') - date(efm.dob)) AND (date('Now') - date(efm.dob)) < 51
                      AND (efm.gender='Female')
                      AND ev.json LIKE '%prostate_cancer_screening%'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
  
  
  - key: "cecap-5-female-31-50"
    grouping: "CECAP"
    description: "Completed Referrals"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                      WHERE
                      31 <= (date('Now') - date(efm.dob)) AND (date('Now') - date(efm.dob)) < 51
                      AND (efm.gender='Female')
                      AND t.business_status = 'Complete'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
    
#    51 - 60
  - key: "cecap-2-male-51-60"
    grouping: "CECAP"
    description: "Number of clients who received education on Reproductive cancer prevention and registered"
    indicatorQuery: "SELECT count(DISTINCT ecv.base_entity_id) as count
                      FROM ec_cecap_visit ecv
                      INNER JOIN ec_family_member efm ON efm.base_entity_id = ecv.entity_id
                      WHERE
                      51 <= (date('Now') - date(efm.dob)) AND (date('Now') - date(efm.dob)) < 61
                      AND (efm.gender='Male')
                      AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) =
                      date(substr(strftime('%Y-%m-%d', datetime(ecv.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                      '-' || substr(strftime('%Y-%m-%d', datetime(ecv.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01')"

  - key: "cecap-3-male-51-60"
    grouping: "CECAP"
    description: "Number of clients who received education on Reproductive cancer prevention and registered"
    indicatorQuery: "SELECT count(DISTINCT ecv.base_entity_id) as count
                      FROM ec_cecap_visit ecv
                      INNER JOIN ec_family_member efm ON efm.base_entity_id = ecv.entity_id
                      INNER JOIN ec_cecap_register ecr ON efm.base_entity_id = ecr.base_entity_id
                      WHERE
                      51 <= (date('Now') - date(efm.dob)) AND (date('Now') - date(efm.dob)) < 61
                      AND hiv_status = 'known_positive'
                      AND topics_covered LIKE '%cervical_cancer%'
                      AND (efm.gender='Male')
                      AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) =
                      date(substr(strftime('%Y-%m-%d', datetime(ecv.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                      '-' || substr(strftime('%Y-%m-%d', datetime(ecv.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01')"
  
  
  
  - key: "cecap-4a-male-51-60"
    grouping: "CECAP"
    description: "Referred for Cervical cancer screening"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                               INNER JOIN event ev on ev.formSubmissionId = t.reason_reference
                      WHERE
                      51 <= (date('Now') - date(efm.dob)) AND (date('Now') - date(efm.dob)) < 61
                      AND (efm.gender='Male')
                      AND ev.json LIKE '%cervical_cancer_screening%'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
  
  
  - key: "cecap-4b-male-51-60"
    grouping: "CECAP"
    description: "Referred for Breasts cancer screening"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                               INNER JOIN event ev on ev.formSubmissionId = t.reason_reference
                      WHERE
                      51 <= (date('Now') - date(efm.dob)) AND (date('Now') - date(efm.dob)) < 61
                      AND (efm.gender='Male')
                      AND ev.json LIKE '%breast_cancer_screening%'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
  
  
  - key: "cecap-4c-male-51-60"
    grouping: "CECAP"
    description: "Referred for Suspicion of cancer"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                               INNER JOIN event ev on ev.formSubmissionId = t.reason_reference
                      WHERE
                      51 <= (date('Now') - date(efm.dob)) AND (date('Now') - date(efm.dob)) < 61
                      AND (efm.gender='Male')
                      AND ev.json LIKE '%suspected_of_having_cancer%'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
  
  
  - key: "cecap-4d-male-51-60"
    grouping: "CECAP"
    description: "Referred for Prostate screening"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                               INNER JOIN event ev on ev.formSubmissionId = t.reason_reference
                      WHERE
                      51 <= (date('Now') - date(efm.dob)) AND (date('Now') - date(efm.dob)) < 61
                      AND (efm.gender='Male')
                      AND ev.json LIKE '%prostate_cancer_screening%'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
  
  
  - key: "cecap-5-male-51-60"
    grouping: "CECAP"
    description: "Completed Referrals"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                      WHERE
                      51 <= (date('Now') - date(efm.dob)) AND (date('Now') - date(efm.dob)) < 61
                      AND (efm.gender='Male')
                      AND t.business_status = 'Complete'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
    
  - key: "cecap-2-female-51-60"
    grouping: "CECAP"
    description: "Number of clients who received education on Reproductive cancer prevention and registered"
    indicatorQuery: "SELECT count(DISTINCT ecv.base_entity_id) as count
                      FROM ec_cecap_visit ecv
                      INNER JOIN ec_family_member efm ON efm.base_entity_id = ecv.entity_id
                      WHERE
                      51 <= (date('Now') - date(efm.dob)) AND (date('Now') - date(efm.dob)) < 61
                      AND (efm.gender='Female')
                      AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) =
                      date(substr(strftime('%Y-%m-%d', datetime(ecv.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                      '-' || substr(strftime('%Y-%m-%d', datetime(ecv.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01')"

  - key: "cecap-3-female-51-60"
    grouping: "CECAP"
    description: "Number of clients who received education on Reproductive cancer prevention and registered"
    indicatorQuery: "SELECT count(DISTINCT ecv.base_entity_id) as count
                      FROM ec_cecap_visit ecv
                      INNER JOIN ec_family_member efm ON efm.base_entity_id = ecv.entity_id
                      INNER JOIN ec_cecap_register ecr ON efm.base_entity_id = ecr.base_entity_id
                      WHERE
                      51 <= (date('Now') - date(efm.dob)) AND (date('Now') - date(efm.dob)) < 61
                      AND hiv_status = 'known_positive'
                      AND topics_covered LIKE '%cervical_cancer%'
                      AND (efm.gender='Female')
                      AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) =
                      date(substr(strftime('%Y-%m-%d', datetime(ecv.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                      '-' || substr(strftime('%Y-%m-%d', datetime(ecv.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01')"
  
  
  
  - key: "cecap-4a-female-51-60"
    grouping: "CECAP"
    description: "Referred for Cervical cancer screening"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                               INNER JOIN event ev on ev.formSubmissionId = t.reason_reference
                      WHERE
                      51 <= (date('Now') - date(efm.dob)) AND (date('Now') - date(efm.dob)) < 61
                      AND (efm.gender='Female')
                      AND ev.json LIKE '%cervical_cancer_screening%'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
  
  
  - key: "cecap-4b-female-51-60"
    grouping: "CECAP"
    description: "Referred for Breasts cancer screening"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                               INNER JOIN event ev on ev.formSubmissionId = t.reason_reference
                      WHERE
                      51 <= (date('Now') - date(efm.dob)) AND (date('Now') - date(efm.dob)) < 61
                      AND (efm.gender='Female')
                      AND ev.json LIKE '%breast_cancer_screening%'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
  
  
  - key: "cecap-4c-female-51-60"
    grouping: "CECAP"
    description: "Referred for Suspicion of cancer"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                               INNER JOIN event ev on ev.formSubmissionId = t.reason_reference
                      WHERE
                      51 <= (date('Now') - date(efm.dob)) AND (date('Now') - date(efm.dob)) < 61
                      AND (efm.gender='Female')
                      AND ev.json LIKE '%suspected_of_having_cancer%'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
  
  
  - key: "cecap-4d-female-51-60"
    grouping: "CECAP"
    description: "Referred for Prostate screening"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                               INNER JOIN event ev on ev.formSubmissionId = t.reason_reference
                      WHERE
                      51 <= (date('Now') - date(efm.dob)) AND (date('Now') - date(efm.dob)) < 61
                      AND (efm.gender='Female')
                      AND ev.json LIKE '%prostate_cancer_screening%'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
  
  
  - key: "cecap-5-female-51-60"
    grouping: "CECAP"
    description: "Completed Referrals"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                      WHERE
                      51 <= (date('Now') - date(efm.dob)) AND (date('Now') - date(efm.dob)) < 61
                      AND (efm.gender='Female')
                      AND t.business_status = 'Complete'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
    
#    61+
  - key: "cecap-2-male-61+"
    grouping: "CECAP"
    description: "Number of clients who received education on Reproductive cancer prevention and registered"
    indicatorQuery: "SELECT count(DISTINCT ecv.base_entity_id) as count
                      FROM ec_cecap_visit ecv
                      INNER JOIN ec_family_member efm ON efm.base_entity_id = ecv.entity_id
                      WHERE
                      61 <= (date('Now') - date(efm.dob))
                      AND (efm.gender='Male')
                      AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) =
                      date(substr(strftime('%Y-%m-%d', datetime(ecv.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                      '-' || substr(strftime('%Y-%m-%d', datetime(ecv.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01')"

  - key: "cecap-3-male-61+"
    grouping: "CECAP"
    description: "Number of clients who received education on Reproductive cancer prevention and registered"
    indicatorQuery: "SELECT count(DISTINCT ecv.base_entity_id) as count
                      FROM ec_cecap_visit ecv
                      INNER JOIN ec_family_member efm ON efm.base_entity_id = ecv.entity_id
                      INNER JOIN ec_cecap_register ecr ON efm.base_entity_id = ecr.base_entity_id
                      WHERE
                      61 <= (date('Now') - date(efm.dob))
                      AND hiv_status = 'known_positive'
                      AND topics_covered LIKE '%cervical_cancer%'
                      AND (efm.gender='Male')
                      AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) =
                      date(substr(strftime('%Y-%m-%d', datetime(ecv.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                      '-' || substr(strftime('%Y-%m-%d', datetime(ecv.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01')"
  
  
  
  - key: "cecap-4a-male-61+"
    grouping: "CECAP"
    description: "Referred for Cervical cancer screening"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                               INNER JOIN event ev on ev.formSubmissionId = t.reason_reference
                      WHERE
                      61 <= (date('Now') - date(efm.dob))
                      AND (efm.gender='Male')
                      AND ev.json LIKE '%cervical_cancer_screening%'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
  
  
  - key: "cecap-4b-male-61+"
    grouping: "CECAP"
    description: "Referred for Breasts cancer screening"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                               INNER JOIN event ev on ev.formSubmissionId = t.reason_reference
                      WHERE
                      61 <= (date('Now') - date(efm.dob))
                      AND (efm.gender='Male')
                      AND ev.json LIKE '%breast_cancer_screening%'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
  
  
  - key: "cecap-4c-male-61+"
    grouping: "CECAP"
    description: "Referred for Suspicion of cancer"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                               INNER JOIN event ev on ev.formSubmissionId = t.reason_reference
                      WHERE
                      61 <= (date('Now') - date(efm.dob))
                      AND (efm.gender='Male')
                      AND ev.json LIKE '%suspected_of_having_cancer%'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
  
  
  - key: "cecap-4d-male-61+"
    grouping: "CECAP"
    description: "Referred for Prostate screening"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                               INNER JOIN event ev on ev.formSubmissionId = t.reason_reference
                      WHERE
                      61 <= (date('Now') - date(efm.dob))
                      AND (efm.gender='Male')
                      AND ev.json LIKE '%prostate_cancer_screening%'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
  
  
  - key: "cecap-5-male-61+"
    grouping: "CECAP"
    description: "Completed Referrals"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                      WHERE
                      61 <= (date('Now') - date(efm.dob))
                      AND (efm.gender='Male')
                      AND t.business_status = 'Complete'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
    
  - key: "cecap-2-female-61+"
    grouping: "CECAP"
    description: "Number of clients who received education on Reproductive cancer prevention and registered"
    indicatorQuery: "SELECT count(DISTINCT ecv.base_entity_id) as count
                      FROM ec_cecap_visit ecv
                      INNER JOIN ec_family_member efm ON efm.base_entity_id = ecv.entity_id
                      WHERE
                      61 <= (date('Now') - date(efm.dob))
                      AND (efm.gender='Female')
                      AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) =
                      date(substr(strftime('%Y-%m-%d', datetime(ecv.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                      '-' || substr(strftime('%Y-%m-%d', datetime(ecv.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01')"

  - key: "cecap-3-female-61+"
    grouping: "CECAP"
    description: "Number of clients who received education on Reproductive cancer prevention and registered"
    indicatorQuery: "SELECT count(DISTINCT ecv.base_entity_id) as count
                      FROM ec_cecap_visit ecv
                      INNER JOIN ec_family_member efm ON efm.base_entity_id = ecv.entity_id
                      INNER JOIN ec_cecap_register ecr ON efm.base_entity_id = ecr.base_entity_id
                      WHERE
                      61 <= (date('Now') - date(efm.dob))
                      AND hiv_status = 'known_positive'
                      AND topics_covered LIKE '%cervical_cancer%'
                      AND (efm.gender='Female')
                      AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) =
                      date(substr(strftime('%Y-%m-%d', datetime(ecv.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                      '-' || substr(strftime('%Y-%m-%d', datetime(ecv.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01')"
  
  
  
  - key: "cecap-4a-female-61+"
    grouping: "CECAP"
    description: "Referred for Cervical cancer screening"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                               INNER JOIN event ev on ev.formSubmissionId = t.reason_reference
                      WHERE
                      61 <= (date('Now') - date(efm.dob))
                      AND (efm.gender='Female')
                      AND ev.json LIKE '%cervical_cancer_screening%'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
  
  
  - key: "cecap-4b-female-61+"
    grouping: "CECAP"
    description: "Referred for Breasts cancer screening"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                               INNER JOIN event ev on ev.formSubmissionId = t.reason_reference
                      WHERE
                      61 <= (date('Now') - date(efm.dob))
                      AND (efm.gender='Female')
                      AND ev.json LIKE '%breast_cancer_screening%'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
  
  
  - key: "cecap-4c-female-61+"
    grouping: "CECAP"
    description: "Referred for Suspicion of cancer"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                               INNER JOIN event ev on ev.formSubmissionId = t.reason_reference
                      WHERE
                      61 <= (date('Now') - date(efm.dob))
                      AND (efm.gender='Female')
                      AND ev.json LIKE '%suspected_of_having_cancer%'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
  
  
  - key: "cecap-4d-female-61+"
    grouping: "CECAP"
    description: "Referred for Prostate screening"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                               INNER JOIN event ev on ev.formSubmissionId = t.reason_reference
                      WHERE
                      61 <= (date('Now') - date(efm.dob))
                      AND (efm.gender='Female')
                      AND ev.json LIKE '%prostate_cancer_screening%'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "
  
  
  - key: "cecap-5-female-61+"
    grouping: "CECAP"
    description: "Completed Referrals"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_cecap_register ear
                               INNER JOIN ec_family_member efm on efm.base_entity_id = ear.base_entity_id
                               INNER JOIN task t on efm.base_entity_id = t.for
                      WHERE
                      61 <= (date('Now') - date(efm.dob))
                      AND (efm.gender='Female')
                      AND t.business_status = 'Complete'
                      AND date(substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(t.authored_on / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')) "